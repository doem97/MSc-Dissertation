%=== CHAPTER SIX (6) ===
%=== Conclusion and Recommendations ===

\chapter{Conclusion and Recommendations}
\label{cha:conclusion}
\begin{spacing}{1.5}
\setlength{\parskip}{0.3in}

\section{Conclusions}

The new trending of utilizing deep learning in the ADAS system have been driving the auto-driving area recent years. Lane and road marking detection is one of those most important tasks within this topic. There are two main problems in the lane and road marking detection: the curved road and the bad weather conditions. Traditional networks perform well on straight road, but can not predict the trend of curved road. Besides, under extreme weather condition, the reflection, blurring and brightness are critical factors that confuses the prediction. In the previous, some research focus on the road marking detection, and some other focus on lane detection, while no research combined the lane and road marking tasks together. Some research utilizes vanishing point to predict the lane in traditional mathematical way, but no significant deep-learning based methods of using vanishing points are proposed.

In our work, we proposed a Refined VPGNet, the RVPG, which mainly have three features. First, it does the lane detection and road marking classification simultaneously. Secondly, it utilizes the vanishing point to guide the lane detection task. Thirdly, it creatively uses the 4-Map, 4-Tiling and 2-D Gaussian layers to better combine training information.

Network uses multi-task to do multiple predictions at the same time. In the network structure, the multi-task branches bifurcates after a fully convolutional layers stack. By using convolutional layers stack, it extracts the higher level features from the input. Multi-task have four branches: the grid box task, the masking task, the multi-label classification task and vanishing point task. By using this four tasks, the data used by any task are shared among all four tasks, thus the network obtains more information and can perform better.

The vanishing point branch gives additional information when predicting the curved road. Inspired by the fact that the human eye uses the vanishing point to predict the trend of lanes implicitly, RVPG explicitly feed the vanishing point into the training process.

However, there are conspicuous weakness in the multi-task and in using the vanishing point. In multi-task, the more branches there are, the more computational resources needed. In the vanishing point utilization, the single frame vanishing point is shown to be an invalid feed scheme, thus a more efficient feeding VP scheme is needed.

RVPG uses 4-Tiling layer, 4-Map layer and 2-D Gaussian layer to address above mentioned issues. 4-Tiling layer is a brand new way to combine feature maps while not increasing the computing resources needed, so by using this layer in the multi-task branches, we can save the computational resources. 4-Map layer is to split the vanishing point information into $5$ channels, four of which represents four corners around the vanishing point. 2-D Gaussian is another method gives contextual information of VP. The use of 4-Map and 2-D Gaussian will avoid the network being trapped.

This work is originally implemented in CAFFE, and we did large amount of work to transplant it to PyTorch. Further researchers can save many time using our PyTorch implementation.

The experimental results are significant. The proposed network can achieve as high as 97.19\% multi-class accuracy. We conducted experiments with different epochs, and collected the experimental loss and accuracy for further reference. In the bad weather conditions, the network can achieve as high as 99.73\% $F_1$ score, even the scene is blurred heavily by rain drops.

\section{Recommendation in Future Work}

% \subsection{Detection under Rainy Condition}

In our work, the PyTorch implementation is still not fully constructed. The basic structure are developed and open sourced\footnote{\url{https://github.com/PrabhuSM16/VPGNet-Pytorch}} already, thus researchers can implement it very quickly without compiling the CAFFE environment. However, the 2-D Gaussian scheme is only implemented in Numpy currently, and is needed to be implemented in PyTorch Tensors. 

For further study, a better designed loss function maybe helpful. After implementation of 2-D Gaussian function, the vanishing point is fed to training process via Gaussian parameters, but that is not enough. As the 2-D Gaussian labels cover a oval area in the ground truth, a loss function measuring vanishing point's similarity in each direction can be designed. The far the predicted vanishing point is compared with the ground truth, the more loss network will receive. Besides, based on that fact that the trending of curved lane have more information distributed in horizontal direction but less information in vertical direction, loss function should have higher weights in horizontal direction.

In multi-task branches, the grid box task is not very significant. Further research may try to remove it.

In our implementation, the network is not pixel-to-pixel mapping but have a scale-reducing (original image is $(480 \times 640)$ but ground truth is resized to $(120 \times 160)$). This is for reducing the computational resources. But in future study, if the grid box task is removed, researchers may have idle computational resources to do training on the original size. 

% \subsection{Improvements on Few Sample Road Markings}



%=== END OF CHAPTER SIX ===
\end{spacing}
\newpage
